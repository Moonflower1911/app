<c-card class="mb-3 booking-item">
  <!--Ref & Total amount-->
  <c-card-header class="bg-secondary-light pb-0">
    <h4 class="card-title mb-0">{{ 'bookings.pages.confirm.booking-item.labels.item'|translate }} {{ index + 1 }}</h4>
    <p class="small">
      Ref: #{{ bookingItem.reference }}
    </p>
  </c-card-header>

  <c-card-body>

    <!--Stay row-->
    <c-row>
      <c-col [md]="12">
        <table cTable [responsive]="true" class="mb-0">
          <tr class="align-middle">
            <td class="text-start">
              <p class="mb-0 pb-0">
                <a [routerLink]="'/properties/units/'+bookingItem.stay.unitRef.id">
                  {{ bookingItem.stay.unitRef.name |titlecase }}</a>
                <span class="small text-muted">
                     |
                  {{ bookingItem.stay.occupancy.adults + ('bookings.pages.new.summary-section.labels.adult'|translate) }}
                  ,
                  {{ getChildrenCount() + ('bookings.pages.new.summary-section.labels.child'|translate) }},
                  {{ getNightCount() + ('bookings.pages.new.summary-section.labels.night'|translate) }}
                </span>
              </p>
              <p class="small mb-0 pt-0">
                {{ 'bookings.pages.confirm.booking-item.labels.from'|translate }}
                <span class="fw-medium">
                      {{ bookingItem.stay.checkinDate|date: 'EEEE, MMM d, y' }}
                  </span>
                {{ 'bookings.pages.confirm.booking-item.labels.to'|translate }}
                <span class="fw-medium">
                      {{ bookingItem.stay.checkoutDate|date: 'EEEE, MMM d, y' }}
                  </span>

                <span>
                    - {{ getNightCount() }} {{ 'bookings.pages.confirm.booking-item.labels.nights'|translate }}
                  </span>
              </p>
            </td>
            <td class=" text-center">
              <span class="text-muted">
                {{ bookingItem.stay.totalPrice.unitPriceInclTax| number:'1.2-2' }} Mad /
                {{ 'bookings.pages.confirm.booking-item.labels.night'|translate }}
              </span>
            </td>
            <td class="text-end ">
              <span class="text-primary fw-bold">{{ getTotal()| number:'1.2-2' }} Mad</span>
            </td>
          </tr>
        </table>
      </c-col>
    </c-row>

    <!--Fees & services-->
    <div class="fees-section mt-2">
      <div class="d-flex align-items-center">
        <h6 class="mb-0 me-1">
          {{ 'bookings.pages.confirm.booking-item.labels.fees' | translate }}
        </h6>
        <span class="small text-muted">
        ({{ bookingItem.fees ? bookingItem.fees.length : 0 }})
      </span>
      </div>
      <c-row class="mt-2">
        <c-col [md]="12">
          @if (bookingItem.fees && bookingItem.fees.length > 0) {
            <table cTable [responsive]="true" class="mb-0">
              @for (fee of bookingItem.fees; track fee.id) {
                <tr class="align-middle">
                  <td class="text-start">
                    <p class="mb-0 pb-0">
                      <a [routerLink]="'/properties/units/'+bookingItem.stay.unitRef.id">
                        {{ fee.feeRef.name |titlecase }}</a>
                      @if (fee.modality != 'PER_STAY') {
                        <span class="small text-muted">
                     |
                          @if (fee.modality == 'PER_PERSON' || fee.modality == 'PER_PERSON_PER_NIGHT') {
                            {{ fee.occupancy.adults + ('bookings.pages.new.summary-section.labels.adult'|translate) }},
                            {{ getFeeChildrenCount(fee) + ('bookings.pages.new.summary-section.labels.child'|translate) }}
                          }
                          @if (fee.modality == 'PER_PERSON_PER_NIGHT') {
                            ,
                          }
                          @if (fee.modality == 'PER_NIGHT' || fee.modality == 'PER_PERSON_PER_NIGHT') {
                            {{ getNightCount() + ('bookings.pages.new.summary-section.labels.night'|translate) }}
                          }
                    </span>
                      }
                    </p>
                    <p class="small mb-0 pt-0">
                      {{ 'bookings.commons.labels.price'|translate }}
                      {{ ('bookings.commons.modality.' + fee.modality + '.text')|translate }}
                    </p>
                  </td>
                  <td class=" text-center">
              <span class="text-muted">
                {{ fee.feeRef.price| number:'1.2-2' }} Mad /
                {{ ('bookings.commons.modality.' + fee.modality + '.symbol')|translate|titlecase }}
              </span>
                  </td>
                  <td class="text-end ">
                    <span class="text-primary fw-bold">{{ fee.price| number:'1.2-2' }} Mad</span>
                  </td>
                </tr>
              }
            </table>

          } @else {
            <p class="text-muted small mb-0">No fees</p>
          }
        </c-col>
      </c-row>
    </div>

    <!--Guests-->
    <div class="guests-section mt-2">
      <div class="d-flex align-items-center">
        <h6 class="mb-0 me-1">
          {{ 'bookings.pages.confirm.booking-item.guests-section.title' | translate }}
        </h6>
        <span class="small text-muted">
        (0)
      </span>
      </div>

      <c-row class="mt-2">
        <c-col [md]="12">
          <p class="text-muted small mb-0">No guests added yet.</p>
        </c-col>
      </c-row>
    </div>

    <!--Payments-->
    <div class="guests-section mt-2">
      <div class="d-flex align-items-center">
        <h6 class="mb-0 me-1">
          {{ 'bookings.pages.confirm.booking-item.payments-section.title' | translate }}
        </h6>
        <span class="small text-muted">
        (0)
      </span>
      </div>

      <c-row class="mt-2">
        <c-col [md]="12">
          <p class="text-muted small mb-0">No payments recorded yet.</p>
        </c-col>
      </c-row>
    </div>

    <!--Notes-->
    <div class="guests-section mt-2">
      <div class="d-flex align-items-center">
        <h6 class="mb-0 me-1">
          {{ 'bookings.pages.confirm.booking-item.notes-section.title' | translate }}
        </h6>
      </div>

      <c-row class="mt-2">
        <c-col [md]="12">
          <textarea cFormControl rows="3"
                    [placeholder]="'bookings.pages.confirm.booking-item.notes-section.note-input.placeholder'|translate"></textarea>
        </c-col>
      </c-row>
    </div>


  </c-card-body>

</c-card>
