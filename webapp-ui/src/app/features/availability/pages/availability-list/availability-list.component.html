<!-- Formulaire de recherche avec style guests-->
<c-row class="mt-3 mb-3">
  <c-col [md]="3" class="form-group mb-3">
    <div *ngIf="!isNavigating">
      <input
        type="text"
        class="form-control"
        [locale]="{applyLabel: 'ok', format: 'DD-MM-YYYY'}"
        ngxDaterangepickerBootstrap
        [(ngModel)]="dateRange"
      />
    </div>
  </c-col>

  <c-col [md]="3">
    <input
      type="number"
      [placeholder]="'availability.check.list.form.guests.placeholder' | translate"
      class="form-control"
      [(ngModel)]="guests"
      min="1">
  </c-col>

  <c-col [md]="2">
    <button
      cButton
      color="primary"
      class="mt-1"
      size="sm"
      (click)="onSearchAvailability()">
      {{ 'availability.check.list.form.search-btn' | translate }}
    </button>
  </c-col>
</c-row>

<!-- État vide style guests -->
@if (!isSearchPerformed) {
  <div class="text-center py-5 mt-5">
    <div class="mb-4">
      <img src="assets/images/animations/search-availability.svg" alt="Search availability" class="search-image">
    </div>
    <h5 class="mb-3 fw-semibold">{{ 'availability.check.list.empty.title' | translate }}</h5>
    <p class="text-muted empty-description">
      {{ 'availability.check.list.empty.description' | translate }}
    </p>
  </div>
} @else {
  @if (units.length > 0) {
    <!-- Nombre de résultats style guests -->
    <div class="mb-3">
      <span>{{ units.length }} {{ 'availability.check.list.results.title' | translate }}</span>
    </div>

    <!-- Tableau des résultats style guests -->
    <div class="table-responsive">
      <table cTable hover [responsive]="true">
        <tbody>
          @for (unit of units; track unit.id) {
            <tr>
              <!-- Colonne Unit avec avatar style guests -->
              <td class="table-col-unit">
                <div class="d-flex align-items-center gap-2">
                  @if (unit.nature === 'MULTI_UNIT') {
                    <c-avatar [size]="'md'" shape="rounded" textColor="white" color="primary" class="multi-unit-avatar">
                      {{ getNameInitials(unit.name) }}
                    </c-avatar>
                  } @else {
                    <c-avatar [size]="'md'" shape="rounded" textColor="white" color="primary">
                      {{ getNameInitials(unit.name) }}
                    </c-avatar>
                  }
                  <div class="d-flex flex-column">
                    <div>
                      <span class="me-1">{{ unit.name }}</span>
                    </div>
                  </div>
                </div>
              </td>

              <!-- Colonne Price per night style guests -->
              <td class="table-col-price">
                <div class="d-flex flex-column">
                  <div class="fw-bold text-dark">{{ getPricePerNight(unit) }}.00 DH</div>
                  <small class="text-body-secondary text-nowrap">{{ 'availability.check.list.results.table.body.per-night' | translate }}</small>
                </div>
              </td>

              <!-- Colonne Minimum stay style guests -->
              <td class="table-col-stay">
                <div class="d-flex flex-column">
                  <div class="fw-bold text-dark">{{ getMinimumStay(unit) }} Night</div>
                  <small class="text-body-secondary text-nowrap">{{ 'availability.check.list.results.table.header.minimum-stay' | translate }}</small>
                </div>
              </td>

              <!-- Colonne Actions style guests -->
              <td class="table-col-actions">
                <button
                  cButton
                  color="primary"
                  size="sm"
                  class="btn-light"
                  (click)="onBookUnit(unit)">
                  {{ 'availability.check.list.results.table.body.book-btn' | translate }}
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  } @else {
    <!-- Message quand aucune unité n'est disponible style guests -->
    <div class="text-center py-5">
      <h5 class="text-muted">{{ 'availability.check.list.results.empty' | translate }}</h5>
    </div>
  }
}
